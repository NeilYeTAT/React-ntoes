受控:

- 使用 value 属性来指定组件的当前值
- 组件的状态由 React 的 state 管理，并通过 onChange 等回调函数来更新状态
- React 完全控制组件的行为和数据流
- 不能直接修改值, 使用 onChange 方法修改值

非受控:

- 组件状态并不受外部环境控制，而是封闭在组件内部
- 非受控组件, 就是不受 react 控制的组件
- 能直接编辑
- 通过 ref 取值, 也可以使用 onChange 方法取值
- 使用 defaultValue 提供初始值, 不通过 state 控制后续的值变化.
- 组件的状态由 DOM 本身管理，React 并不直接控制其值.

示例:

```tsx
// 非受控, 使用了 defaultValue
function App() {
  function onChange(event: ChangeEvent<HTMLInputElement>) {
    console.log(event.target.value);
  }

  return <input defaultValue={"default"} onChange={onChange} />;
}

// 受控, 通过 setState 方法修改值
function App() {
  const [value, setValue] = useState("default");

  function onChange(event: ChangeEvent<HTMLInputElement>) {
    console.log(event.target.value); // setValue 触发重新渲染
    setValue(event.target.value); // 如果不使用 setValue, 将无法修改值
  }

  return <input value={value} onChange={onChange} />;
}
```

总结: 一般情况下, 不需要对表单值处理, 就直接使用非受控就好了.
当需要对输入的值做处理之后设置到表单的时候，或者是你想实时同步状态值到父组件时使用受控.

## 同时支持受控和非受控模式

如何实现? 需要思考受控和非受控的区别是什么, 通过差异区分.

传入的是 value 还是 defaultValue?
当传入了 value 时, 组件就是受控组件了, 因为用户无法通过操作修改 value 值, 只能我们通过代码修改.
**关注点应该才 value 上!!**


如果是受控模式，useState 的初始值设置 props.value，然后渲染用 props.value。

如果是非受控模式，那渲染用内部 state 的 value，然后 changeValue 里 setValue。

当不是首次渲染，但 value 变为 undefined 的情况，也就是从受控模式切换到了非受控模式，要同步设置 state 为 propsValue。

这样，组件就同时支持了受控和非受控模式。
